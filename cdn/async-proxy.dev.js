var t=r();self.asyncProxyScriptBlob=new t;
function r(){function b(){this.c=["'use strict';"];this.aa=this.B=null;this.Ua={};this.g(r,"BlobScriptGenerator");this.m("var asyncProxyScriptBlob = new BlobScriptGenerator();")}b.prototype.g=function(c,a,e,b){if(this.B)throw Error("Cannot add member to AsyncProxyScriptBlob after blob was used");a&&(e?(this.Ua[e]=!0,this.c.push(e),this.c.push(".")):this.c.push("var "),this.c.push(a),this.c.push(" = "));this.c.push("(");this.c.push(c.toString());this.c.push(")(");this.c.push(b||"");this.c.push(");")};
b.prototype.m=function(c){if(this.B)throw Error("Cannot add statement to AsyncProxyScriptBlob after blob was used");this.c.push(c)};b.prototype.getBlob=function(){this.B||(this.B=new Blob(this.c,{type:"application/javascript"}));return this.B};b.prototype.fb=function(){this.aa||(this.aa=URL.createObjectURL(this.getBlob()));return this.aa};return b};function u(){function b(e){if(null===a)throw"AsyncProxy internal error: SubWorkerEmulationForChrome not initialized";this.T=++c;a[this.T]=this;self.postMessage({type:"subWorkerCtor",v:this.T,qb:e})}var c=0,a=null;b.ib=function(c){a=c};b.prototype.postMessage=function(a,c){self.postMessage({type:"subWorkerPostMessage",v:this.T,data:a},c)};b.prototype.terminate=function(a,c){self.postMessage({type:"subWorkerTerminate",v:this.T},c)};self.asyncProxyScriptBlob.g(u,"SubWorkerEmulationForChrome");return b}
var v=u();function w(){function b(q,e,f,d){var h=this;d=d||{};var k=c.toString(),k=k.replace("SCRIPT_PLACEHOLDER",g.fb()),k=URL.createObjectURL(new Blob(["(",k,")()"],{type:"application/javascript"}));h.f=[];h.F=[];h.ha=[];h.ia=[];h.W=new Worker(k);h.W.onmessage=function(c){a(h,c)};h.ka=null;h.O=0;h.ua=d.functionsBufferSize||5;h.fa=[];h.W.postMessage({ma:"ctor",rb:q,cb:e,s:f,b:++l,Ia:!1,lb:b.Ea()})}function c(){importScripts("SCRIPT_PLACEHOLDER");AsyncProxy.AsyncProxySlave=self.AsyncProxy.AsyncProxySlaveSingleton;
AsyncProxy.AsyncProxySlave.Ta()}function a(a,c){var b=c.data.b;switch(c.data.type){case "functionCalled":--a.O;d(a);break;case "promiseResult":var f=a.F[b];delete a.F[b];f.resolve(c.data.result);break;case "promiseFailure":f=a.F[b];delete a.F[b];f.reject(c.data.reason);break;case "userData":null!==a.ka&&a.ka(c.data.Bb);break;case "callback":b=a.f[c.data.b];if(void 0===b)throw"Unexpected message from SlaveWorker of callback ID: "+c.data.b+". Maybe should indicate isMultipleTimesCallback = true on creation?";
b.pa||a.Da(a.f[c.data.b]);null!==b.Ba&&b.Ba.apply(null,c.data.s);break;case "subWorkerCtor":var b=new Worker(c.data.qb),h=c.data.v;a.ha[h]=b;a.ia.push(b);b.onmessage=function(c){e(a,c.ports,!1,{ma:"subWorkerOnMessage",v:h,data:c.data})};break;case "subWorkerPostMessage":b=a.ha[c.data.v];b.postMessage(c.data.data);break;case "subWorkerTerminate":b=a.ha[c.data.v];b.terminate();break;default:throw"Unknown message from AsyncProxySlave of type: "+c.data.type;}}function e(a,c,b,e){a.O>=a.ua?a.fa.push({Ab:c,
jb:b,message:e}):f(a,c,b,e)}function f(a,c,b,e){b&&++a.O;a.W.postMessage(e,c)}function d(a){for(;a.O<a.ua&&0<a.fa.length;){var c=a.fa.shift();f(a,c.Ab,c.jb,c.message)}}var g=self.asyncProxyScriptBlob,l=0,h=!1,k=function(){var a=location.href,c=a.lastIndexOf("/");0<=c&&(a=a.substring(0,c));return a}();b.prototype.xb=function(a){this.ka=a};b.prototype.terminate=function(){this.W.terminate();for(var a=0;a<this.ia.length;++a)this.ia[a].terminate()};b.prototype.Aa=function(a,c,b){b=b||{};var d=!!b.isReturnPromise,
h=b.transferables,g=b.pathsToTransferablesInPromiseResult,k=++l,n=null,p=this;d&&(n=new Promise(function(a,c){p.F[k]={resolve:a,reject:c}}));(b.isSendImmediately?f:e)(this,h,!0,{ma:a,s:c||[],b:k,Ia:d,pb:g});if(d)return n};b.prototype.Cb=function(a,c,b){b=b||{};var e=++l;c={kb:!0,pa:!!b.isMultipleTimeCallback,b:e,bb:c,Ka:b.pathsToTransferables};this.f[e]={pa:!!b.isMultipleTimeCallback,b:e,Ba:a,Ka:b.pathsToTransferables};return c};b.prototype.Da=function(a){delete this.f[a.b]};b.Ea=function(){h=!0;
return k};b.Xa=function(a){if(k!==a&&h)throw"Previous values returned from getMasterEntryUrl is wrong. Avoid calling it within the slave c`tor";k=a};g.g(w,"AsyncProxyMaster");return b}var x=w();function y(){function b(){var a;try{for(var c=h.split("."),b=self,f=0;f<c.length;++f)b=b[c[f]];var c=b,d=[null].concat(e(arguments));a=new (Function.prototype.bind.apply(c,d))}catch(g){throw Error("Failed locating class name "+h+": "+g);}return a}function c(a,c){if(void 0!==a){for(var b=Array(a.length),e=0;e<a.length;++e){for(var f=a[e],d=c,h=0;h<f.length;++h)d=d[f[h]];b[e]=d}return b}}function a(a){var c=a.data.ma,e=a.data.s,d=a.data.b,k=a.data.Ia,M=a.data.pb;switch(c){case "ctor":self.AsyncProxy.AsyncProxyMaster.Xa(a.data.lb);
d=a.data.rb;h=a.data.cb;for(var m=0;m<d.length;++m)importScripts(d[m]);g=b.apply(null,e);return;case "subWorkerOnMessage":l[a.data.v].onmessage({data:a.data.data});return}e=Array(a.data.s.length);for(m=0;m<a.data.s.length;++m){var n=a.data.s[m];void 0!==n&&null!==n&&n.kb&&(n=f.Oa(n));e[m]=n}for(var m=g,p;m&&!(p=g[c]);)m=m.__proto__;if(!p)throw"AsyncProxy error: could not find function "+p;e=p.apply(g,e);k&&f.Pa(d,e,M);self.postMessage({type:"functionCalled",b:a.data.b,result:null})}function e(a){for(var c=
Array(a.length),b=0;b<a.length;++b)c[b]=a[b];return c}var f={},d=null,g,l={},h;f.Ta=function(){self.onmessage=a};f.wb=function(a){b=a};f.tb=function(a){d=a};f.sb=function(a){self.postMessage({type:"userData",Bb:a})};f.Pa=function(a,b,e){b.then(function(b){var d=c(e,b);self.postMessage({type:"promiseResult",b:a,result:b},d)})["catch"](function(c){self.postMessage({type:"promiseFailure",b:a,reason:c})})};f.Oa=function(a){var b=!1;return function(){if(b)throw"Callback is called twice but isMultipleTimeCallback = false";
var f=e(arguments);if(null!==d)try{d.call(g,"callback",a.bb,f)}catch(h){console.log("AsyncProxySlave.beforeOperationListener has thrown an exception: "+h)}var k=c(a.Ka,f);self.postMessage({type:"callback",b:a.b,s:f},k);a.pa||(b=!0)}};f.ca=function(){return z.ca(Error())};if(void 0===self.Worker){var k=self.SubWorkerEmulationForChrome;k.ib(l);self.Worker=k}self.asyncProxyScriptBlob.g(y,"AsyncProxySlaveSingleton");return f}var A=y();function B(){function b(){this.ga={};this.G=null}b.prototype.ab=function(c){c=b.ca(c);this.ga[c]||(this.ga[c]=!0,this.G=null)};b.prototype.gb=function(){if(null===this.G){this.G=[];for(var c in this.ga)this.G.push(c)}return this.G};b.ca=function(c){var a=c.stack.trim(),b=/at (|[^ ]+ \()([^ ]+):\d+:\d+/.exec(a);if(b&&""!==b[2])return b[2];if((b=(new RegExp(/.+\/(.*?):\d+(:\d+)*$/)).exec(a))&&""!==b[1])return b[1];if(void 0!=c.fileName)return c.fileName;throw"ImageDecoderFramework.js: Could not get current script URL";
};self.asyncProxyScriptBlob.g(B,"ScriptsToImportPool");return b}var z=B();var C=function(){function b(){this.clear()}b.prototype.clear=function(){this.ba={j:null,P:this};this.N={i:null,P:this};this.C=0;this.N.j=this.ba;this.ba.i=this.N};b.prototype.add=function(c,a){if(null===a||void 0===a)a=this.N;this.V(a);++this.C;var b={$a:c,i:a,j:a.j,P:this};b.j.i=b;return a.j=b};b.prototype.remove=function(c){this.V(c);--this.C;c.j.i=c.i;c.i.j=c.j;c.P=null};b.prototype.I=function(c){this.V(c);return c.$a};b.prototype.H=function(){return this.A(this.ba)};b.prototype.A=function(c){this.V(c);
return c.i===this.N?null:c.i};b.prototype.V=function(c){if(c.P!==this)throw"iterator must be of the current LinkedList";};return b}();var D=function(){function b(c){this.L=[];this.M=c}b.prototype.Fa=function(c){var a=this.M.getHashCode(c),a=this.L[a];if(!a)return null;for(var b=a.H();null!==b;){var f=a.I(b);if(this.M.isEqual(f.key,c))return f.value;b=a.A(b)}return null};b.prototype.Na=function(c,a){var b=this.M.getHashCode(c),f=this.L[b];f||(f=new C,this.L[b]=f);b={Sa:b,wa:f,o:null};for(b.o=f.H();null!==b.o;){var d=f.I(b.o);if(this.M.isEqual(d.key,c))return{iterator:b,Ha:!1,value:d.value};b.o=f.A(b.o)}d=a();b.o=f.add({key:c,value:d});
return{iterator:b,Ha:!0,value:d}};b.prototype.remove=function(b){b.wa.remove(b.o);0===b.wa.C&&delete this.L[b.Sa]};return b}();function E(){function b(a,b,c,d){this.X=d;this.Ra=b;this.Qa=c;this.Wa=a;this.da=new D(d);this.la=[];if(!d.createTaskContext)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.createTaskContext() method";if(!d.getHashCode)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.getHashCode() method";if(!d.isEqual)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.isEqual() method";}var c=self.asyncProxyScriptBlob;b.prototype.sa=function(a,b){var c=this.da.Na(a,function(){return new F}),
d=c.value,g=new G(d,b);c.Ha&&(d.ub(this.da,c.iterator),this.Ya(a,d));return g};b.prototype.hb=function(a){a=this.da.Fa(a);return null===a?null:a.$};b.prototype.Ya=function(a,b){taskContext=this.X.createTaskContext(a,{onDataReadyToProcess:function(c){if(b.Z)throw"AsyncProxy.DependencyWorkers: already terminated";b.J?(b.ra=c,b.qa=!0):d.za(b,c,a)},onTerminated:b.ob});b.$=taskContext;var c=taskContext.dependsOnTasks;if(!taskContext.statusUpdated)throw"AsyncProxy.DependencyWorkers: missing taskContext.statusUpdated()";
if(c&&!taskContext.onDependencyTaskResult)throw"AsyncProxy.DependencyWorkers: Cannot accept dependsOnTasks without onDependencyTaskResult in taskContext";var d=this;b.Y=Array(c.length);for(var g=0;g<c.length;++g){b.Y[g]=!1;var l;(function(a){var g=!1;l=d.sa(c[a],{onData:function(d){b.$.onDependencyTaskResult(d,c[a]);b.Y[a]=!0},onTerminated:function(){if(g)throw"AsyncProxy.DependencyWorkers: Double termination";g=!0;b.eb()}})})(g);b.w.push(l)}setTimeout(function(){for(var a=0;a<b.w.length;++a){var d=
b.w[a];if(!b.Y[a]&&d.oa())taskContext.onDependencyTaskResult(d.na(),c[a])}})};b.prototype.za=function(a,b,c){var d=this,g;g=0<d.la.length?d.la.pop():new x(d.Wa,d.Ra,d.Qa);a.J=!0;a.K();g.Aa("start",[b,c],{isReturnPromise:!0}).then(function(b){a.Ga=!0;a.Ja=b;for(var d=a.h,e=d.H();null!=e;){var g=d.I(e),e=d.A(e);g.f.onData(b,c)}return b})["catch"](function(a){console.log("Error in DependencyWorkers' worker: "+a);return a}).then(function(b){d.la.push(g);if(a.qa){var c=a.ra;a.qa=!1;a.ra=null;d.za(a,c);
return b}a.J=!1;a.K()})};c.g(E,"DependencyWorkers");return b}var H=E();var G=function I(){function c(a,c){this.a=a;this.ea=0;this.f=c;this.U=a.h.add(this)}c.prototype.oa=function(){return this.a.Ga};c.prototype.na=function(){return this.a.Ja};c.prototype.vb=function(a){if(!this.U)throw"AsyncProxy.DependencyWorkers: Already unregistered";a=a>this.a.u?a:this.ea<this.a.u?this.a.u:this.a.La();this.a.Ma(a)};c.prototype.unregister=function(){if(!this.U)throw"AsyncProxy.DependencyWorkers: Already unregistered";this.a.h.remove(this.U);this.U=null;if(0==this.a.h.C)this.a.Z||
(this.a.ended(),this.a.K());else if(this.ea===this.a.u){var a=this.a.La();this.a.Ma(a)}};asyncProxyScriptBlob.g(I,"DependencyWorkersTaskHandle");return c}();var F=function(){function b(){this.Z=!1;this.u=0;this.Ja=null;this.qa=this.J=this.Ga=!1;this.$=this.ra=null;this.w=[];this.h=new C;this.Y=[];this.Ca=0;this.ob=this.nb.bind(this)}b.prototype.ub=function(b,a){this.Va=b;this.xa=a};b.prototype.ended=function(){for(var b=this.w,a=0;a<b.length;++a)b[a].unregister();for(b=this.h.H();null!=b;)if(a=this.h.I(b),b=this.h.A(b),a.f.onTerminated)a.f.onTerminated();this.h.clear();this.w=[];this.Va.remove(this.xa);this.xa=null};b.prototype.Ma=function(b){if(this.u!==
b){this.u=b;this.K();for(var a=this.w,e=0;e<a.length;++e)a[e].setPriority(b)}};b.prototype.K=function(){this.$.statusUpdated({priority:this.u,hasListeners:0<this.h.C,isIdle:!this.J,terminatedDependsTasks:this.Ca})};b.prototype.La=function(){for(var b=this.h,a=b.H(),e=0;null!=a;)e=b.I(a).ea,a=b.A(a);return e};b.prototype.nb=function(){if(this.Z)throw"AsyncProxy.DependencyWorkers: already terminated";if(this.J)throw"AsyncProxy.DependencyWorkers: Cannot terminate while task is processing. Wait for statusUpdated() callback with isIdle == true";
this.Z=!0;this.ended()};b.prototype.eb=function(){++this.Ca;this.K()};return b}();function J(){function b(a,b,c,d){this.Za=a;this.D=b;this.X=c;this.f=d;this.S=null;this.ya=[];this.va=[];this.l=1;this.ta()}var c=self.asyncProxyScriptBlob;Object.defineProperty(b.prototype,"dependsOnTasks",{get:function(){return this.D}});b.prototype.mb=function(a,b){if(1!==this.l)throw"AsyncProxy.PromiseTask: Internal Error: not waiting for tasks depends on";if(null===this.S){this.S=new D(this.X);for(var c=0;c<this.D.length;++c)this.S.Na(this.D[c],function(){return c})}var d=this.S.Fa(b);if(null===
d)throw"AsyncProxy.PromiseTask: Task is not depends on key";this.ya[d]=a;this.va[d]||(this.va[d]=!0)};b.prototype.zb=function(a){!a.hasListeners&&a.isIdle?this.ja("No listeners"):1===this.l?this.ta(a):a.isIdle&&3===this.l&&this.ja()};b.prototype.ta=function(a){var b=0;a&&(b=a.terminatedDependsTasks);if(b===this.D.length){var c=this;this.l=2;this.X.preWorkerProcess(this.ya,this.D,this.Za).then(function(a){4!==c.l&&(c.l=3,c.f.onDataReadyToProcess(a))})["catch"](function(a){c.ja(a)})}};b.prototype.ja=
function(a){4!==this.l&&(this.l=4,this.f.onTerminated(a))};c.g(J,"PromiseTask");return b}var K=J();function L(b){function c(c,d,e,l){b.call(this,c,d,e,a(l));if(!l.getDependsOnTasks)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.getDependsOnTasks() method";if(!l.preWorkerProcess)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.preWorkerProcess() method";if(!l.getHashCode)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.getHashCode() method";if(!l.isEqual)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.isEqual() method";}function a(a){return{R:a,
createTaskContext:function(a,b){var c=this.R.getDependsOnTasks(a);return new K(a,c,this.R,b)},getHashCode:function(a){return this.R.getHashCode(a)},isEqual:function(a,b){return this.R.isEqual(a,b)}}}var e=self.asyncProxyScriptBlob;c.prototype=Object.create(b.prototype);c.prototype.yb=function(a){var b=this;return new Promise(function(c,e){var h=b.sa(a,{onData:function(a){k=!0;q=a},onTerminated:function(){k?c(q):e("AsyncProxy.PromiseDependencyWorkers: Internal error - task terminated but no data returned")}}),
k=h.oa(),q;k&&(q=h.na())})};e.g(L,"PromiseDependencyWorkers",null,"DependencyWorkers");return c}var N=L(H);function O(){asyncProxyScriptBlob.g(O,"ExportAsyncProxySymbols");asyncProxyScriptBlob.m("ExportAsyncProxySymbols(SubWorkerEmulationForChrome, AsyncProxySlaveSingleton, AsyncProxyMaster, ScriptsToImportPool, DependencyWorkers, DependencyWorkersTaskHandle, PromiseTask, PromiseDependencyWorkers);");asyncProxyScriptBlob.m("self['AsyncProxy']['AsyncProxySlaveSingleton'] = AsyncProxySlaveSingleton;");asyncProxyScriptBlob.m("self['AsyncProxy']['AsyncProxyMaster'] = AsyncProxyMaster;");asyncProxyScriptBlob.m("self['AsyncProxy']['ScriptsToImportPool'] = ScriptsToImportPool;");
asyncProxyScriptBlob.m("self['AsyncProxy']['DependencyWorkers'] = DependencyWorkers;");asyncProxyScriptBlob.m("self['AsyncProxy']['PromiseTask'] = PromiseTask;");asyncProxyScriptBlob.m("self['AsyncProxy']['PromiseDependencyWorkers'] = PromiseDependencyWorkers;");return function(b,c,a,e,f,d,g,l){self.AsyncProxy=self.AsyncProxy||{};b.prototype.postMessage=b.prototype.postMessage;b.prototype.terminate=b.prototype.terminate;c.setSlaveSideCreator=c.wb;c.setBeforeOperationListener=c.tb;c.sendUserDataToMaster=
c.sb;c.wrapPromiseFromSlaveSide=c.Pa;c.wrapCallbackFromSlaveSide=c.Oa;a.prototype.setUserDataHandler=a.prototype.xb;a.prototype.terminate=a.prototype.terminate;a.prototype.callFunction=a.prototype.Aa;a.prototype.wrapCallback=a.prototype.Cb;a.prototype.freeCallback=a.prototype.Da;a.getEntryUrl=a.Ea;e.prototype.addScriptFromErrorWithStackTrace=e.prototype.ab;e.prototype.getScriptsForWorkerImport=e.prototype.gb;f.prototype.startTask=f.prototype.sa;f.prototype.getTaskContext=f.prototype.hb;d.prototype.hasData=
d.prototype.oa;d.prototype.getLastData=d.prototype.na;d.prototype.setPriority=d.prototype.vb;d.prototype.unregister=d.prototype.unregister;g.prototype.onDependencyTaskResult=g.prototype.mb;g.prototype.statusUpdated=g.prototype.zb;l.prototype.startTaskPromise=l.prototype.yb}}O()(v,A,x,z,H,G,K,N);self.AsyncProxy.AsyncProxySlaveSingleton=A;self.AsyncProxy.AsyncProxyMaster=x;self.AsyncProxy.ScriptsToImportPool=z;self.AsyncProxy.DependencyWorkers=H;self.AsyncProxy.PromiseTask=K;
self.AsyncProxy.PromiseDependencyWorkers=N;
