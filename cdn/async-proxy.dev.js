var v=u();self.asyncProxyScriptBlob=new v;
function u(){function b(){this.g=["'use strict';"];this.ca=this.H=null;this.$a={};this.s(u,"BlobScriptGenerator");this.B("var asyncProxyScriptBlob = new BlobScriptGenerator();")}b.prototype.s=function(c,a,e,b){if(this.H)throw Error("Cannot add member to AsyncProxyScriptBlob after blob was used");a&&(e?(this.$a[e]=!0,this.g.push(e),this.g.push(".")):this.g.push("var "),this.g.push(a),this.g.push(" = "));this.g.push("(");this.g.push(c.toString());this.g.push(")(");this.g.push(b||"");this.g.push(");")};
b.prototype.B=function(c){if(this.H)throw Error("Cannot add statement to AsyncProxyScriptBlob after blob was used");this.g.push(c)};b.prototype.getBlob=function(){this.H||(this.H=new Blob(this.g,{type:"application/javascript"}));return this.H};b.prototype.lb=function(){this.ca||(this.ca=URL.createObjectURL(this.getBlob()));return this.ca};return b};function w(){function b(e){if(null===a)throw"AsyncProxy internal error: SubWorkerEmulationForChrome not initialized";this.X=++c;a[this.X]=this;self.postMessage({type:"subWorkerCtor",F:this.X,wb:e})}var c=0,a=null;b.sa=function(c){a=c};b.prototype.postMessage=function(a,c){self.postMessage({type:"subWorkerPostMessage",F:this.X,data:a},c)};b.prototype.terminate=function(a,c){self.postMessage({type:"subWorkerTerminate",F:this.X},c)};self.asyncProxyScriptBlob.s(w,"SubWorkerEmulationForChrome");return b}
var x=w();function y(){function b(t,e,f,d){var m=this;d=d||{};var p=c.toString(),p=p.replace("SCRIPT_PLACEHOLDER",g.lb()),p=URL.createObjectURL(new Blob(["(",p,")()"],{type:"application/javascript"}));m.h=[];m.J=[];m.ka=[];m.la=[];m.$=new Worker(p);m.$.onmessage=function(c){a(m,c)};m.na=null;m.T=0;m.Ca=d.functionsBufferSize||5;m.ia=[];m.$.postMessage({pa:"ctor",xb:t,kb:e,C:f,b:++h,Oa:!1,rb:b.La()})}function c(){importScripts("SCRIPT_PLACEHOLDER");AsyncProxy.AsyncProxySlave=self.AsyncProxy.AsyncProxySlaveSingleton;
AsyncProxy.AsyncProxySlave.Za()}function a(a,c){var b=c.data.b;switch(c.data.type){case "functionCalled":--a.T;d(a);break;case "promiseResult":var f=a.J[b];delete a.J[b];f.resolve(c.data.result);break;case "promiseFailure":f=a.J[b];delete a.J[b];f.reject(c.data.reason);break;case "userData":null!==a.na&&a.na(c.data.Fb);break;case "callback":b=a.h[c.data.b];if(void 0===b)throw"Unexpected message from SlaveWorker of callback ID: "+c.data.b+". Maybe should indicate isMultipleTimesCallback = true on creation?";
b.ta||a.Ka(a.h[c.data.b]);null!==b.Ja&&b.Ja.apply(null,c.data.C);break;case "subWorkerCtor":var b=new Worker(c.data.wb),g=c.data.F;a.ka[g]=b;a.la.push(b);b.onmessage=function(c){e(a,c.ports,!1,{pa:"subWorkerOnMessage",F:g,data:c.data})};break;case "subWorkerPostMessage":b=a.ka[c.data.F];b.postMessage(c.data.data);break;case "subWorkerTerminate":b=a.ka[c.data.F];b.terminate();break;default:throw"Unknown message from AsyncProxySlave of type: "+c.data.type;}}function e(a,c,b,e){a.T>=a.Ca?a.ia.push({Eb:c,
pb:b,message:e}):f(a,c,b,e)}function f(a,c,b,e){b&&++a.T;a.$.postMessage(e,c)}function d(a){for(;a.T<a.Ca&&0<a.ia.length;){var c=a.ia.shift();f(a,c.Eb,c.pb,c.message)}}var g=self.asyncProxyScriptBlob,h=0,n=!1,k=function(){var a=location.href,c=a.lastIndexOf("/");0<=c&&(a=a.substring(0,c));return a}();b.prototype.Bb=function(a){this.na=a};b.prototype.terminate=function(){this.$.terminate();for(var a=0;a<this.la.length;++a)this.la[a].terminate()};b.prototype.Ia=function(a,c,b){b=b||{};var d=!!b.isReturnPromise,
g=b.transferables,n=b.pathsToTransferablesInPromiseResult,l=++h,k=null,r=this;d&&(k=new Promise(function(a,c){r.J[l]={resolve:a,reject:c}}));(b.isSendImmediately?f:e)(this,g,!0,{pa:a,C:c||[],b:l,Oa:d,ub:n});if(d)return k};b.prototype.Gb=function(a,c,b){b=b||{};var e=++h;c={qb:!0,ta:!!b.isMultipleTimeCallback,b:e,jb:c,Qa:b.pathsToTransferables};this.h[e]={ta:!!b.isMultipleTimeCallback,b:e,Ja:a,Qa:b.pathsToTransferables};return c};b.prototype.Ka=function(a){delete this.h[a.b]};b.La=function(){n=!0;
return k};b.eb=function(a){if(k!==a&&n)throw"Previous values returned from getMasterEntryUrl is wrong. Avoid calling it within the slave c`tor";k=a};g.s(y,"AsyncProxyMaster");return b}var z=y();function A(){function b(){var a;try{for(var c=n.split("."),b=self,d=0;d<c.length;++d)b=b[c[d]];var c=b,f=[null].concat(e(arguments));a=new (Function.prototype.bind.apply(c,f))}catch(g){throw Error("Failed locating class name "+n+": "+g);}return a}function c(a,c){if(void 0!==a){for(var b=Array(a.length),e=0;e<a.length;++e){for(var d=a[e],f=c,g=0;g<d.length;++g)f=f[d[g]];b[e]=f}return b}}function a(a){var c=a.data.pa,e=a.data.C,d=a.data.b,k=a.data.Oa,p=a.data.ub;switch(c){case "ctor":self.AsyncProxy.AsyncProxyMaster.eb(a.data.rb);
d=a.data.xb;n=a.data.kb;for(var l=0;l<d.length;++l)importScripts(d[l]);g=b.apply(null,e);return;case "subWorkerOnMessage":h[a.data.F].onmessage({data:a.data.data});return}e=Array(a.data.C.length);for(l=0;l<a.data.C.length;++l){var q=a.data.C[l];void 0!==q&&null!==q&&q.qb&&(q=f.Ua(q));e[l]=q}for(var l=g,r;l&&!(r=g[c]);)l=l.__proto__;if(!r)throw"AsyncProxy error: could not find function "+r;e=r.apply(g,e);k&&f.Va(d,e,p);self.postMessage({type:"functionCalled",b:a.data.b,result:null})}function e(a){for(var c=
Array(a.length),b=0;b<a.length;++b)c[b]=a[b];return c}var f={},d=null,g,h={},n;f.Za=function(){self.onmessage=a};f.Ab=function(a){b=a};f.zb=function(a){d=a};f.yb=function(a){self.postMessage({type:"userData",Fb:a})};f.Va=function(a,b,e){b.then(function(b){var d=c(e,b);self.postMessage({type:"promiseResult",b:a,result:b},d)})["catch"](function(c){self.postMessage({type:"promiseFailure",b:a,reason:c})})};f.Ua=function(a){var b=!1;return function(){if(b)throw"Callback is called twice but isMultipleTimeCallback = false";
var f=e(arguments);if(null!==d)try{d.call(g,"callback",a.jb,f)}catch(h){console.log("AsyncProxySlave.beforeOperationListener has thrown an exception: "+h)}var k=c(a.Qa,f);self.postMessage({type:"callback",b:a.b,C:f},k);a.ta||(b=!0)}};f.ea=function(){return B.ea(Error())};if(void 0===self.Worker){var k=self.SubWorkerEmulationForChrome;k.sa(h);self.Worker=k}self.asyncProxyScriptBlob.s(A,"AsyncProxySlaveSingleton");return f}var C=A();function D(){function b(){this.ja={};this.K=null}b.prototype.ib=function(c){c=b.ea(c);this.ja[c]||(this.ja[c]=!0,this.K=null)};b.prototype.mb=function(){if(null===this.K){this.K=[];for(var c in this.ja)this.K.push(c)}return this.K};b.ea=function(c){var a=c.stack.trim(),b=/at (|[^ ]+ \()([^ ]+):\d+:\d+/.exec(a);if(b&&""!==b[2])return b[2];if((b=(new RegExp(/.+\/(.*?):\d+(:\d+)*$/)).exec(a))&&""!==b[1])return b[1];if(void 0!=c.fileName)return c.fileName;throw"ImageDecoderFramework.js: Could not get current script URL";
};self.asyncProxyScriptBlob.s(D,"ScriptsToImportPool");return b}var B=D();var E=function(){function b(){this.clear()}b.prototype.clear=function(){this.da={w:null,U:this};this.R={v:null,U:this};this.i=0;this.R.w=this.da;this.da.v=this.R};b.prototype.add=function(c,a){if(null===a||void 0===a)a=this.R;this.Z(a);++this.i;var b={hb:c,v:a,w:a.w,U:this};b.w.v=b;return a.w=b};b.prototype.remove=function(c){this.Z(c);--this.i;c.w.v=c.v;c.v.w=c.w;c.U=null};b.prototype.l=function(c){this.Z(c);return c.hb};b.prototype.j=function(){return this.m(this.da)};b.prototype.m=function(c){this.Z(c);
return c.v===this.R?null:c.v};b.prototype.Z=function(c){if(c.U!==this)throw"iterator must be of the current LinkedList";};return b}();var F=function(){function b(c){this.S=[];this.G=new E;this.P=c;this.i=0}b.prototype.Ma=function(c){var a=this.P.getHashCode(c),a=this.S[a];if(!a)return null;for(var a=a.list,b=a.j();null!==b;){var f=a.l(b);if(this.P.isEqual(f.key,c))return f.value;b=a.m(b)}return null};b.prototype.l=function(c){return c.c.list.l(c.f).value};b.prototype.za=function(c,a){var b=this.P.getHashCode(c),f=this.S[b];f||(f={ob:b,list:new E,wa:null},f.wa=this.G.add(f),this.S[b]=f);b={c:f,f:null};for(b.f=f.list.j();null!==b.f;){var d=
f.list.l(b.f);if(this.P.isEqual(d.key,c))return{iterator:b,ua:!1,value:d.value};b.f=f.list.m(b.f)}d=a();b.f=f.list.add({key:c,value:d});++this.i;return{iterator:b,ua:!0,value:d}};b.prototype.remove=function(c){var a=c.c.list.i;c.c.list.remove(c.f);var b=c.c.list.i;this.i+=b-a;0===b&&(this.G.remove(c.c.wa),delete this.S[c.c.ob])};b.prototype.j=function(){var c=this.G.j(),a=null,b=null;null!==c&&(a=this.G.l(c),b=a.list.j());return null===b?null:{c:a,f:b}};b.prototype.m=function(c){for(var a={c:c.c,
f:c.c.list.m(c.f)};null===a.f;){var b=this.G.m(c.c.wa);if(null===b)return null;a.c=this.G.l(b);a.f=a.c.list.j()}return a};return b}();function G(){function b(a,c,b,d){this.L=d;this.Xa=c;this.Wa=b;this.cb=a;this.fa=new F(d);this.oa=[];if(!d.createTaskContext)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.createTaskContext() method";if(!d.getHashCode)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.getHashCode() method";if(!d.isEqual)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.isEqual() method";}var c=self.asyncProxyScriptBlob;b.prototype.ya=function(a,c){var b=this.fa.za(a,function(){return new H}),
d=b.value,g=new I(d,c);b.ua&&(d.sa(this,this.fa,b.iterator,this.L),this.fb(a,d));return g};b.prototype.nb=function(a){a=this.fa.Ma(a);return null===a?null:a.ba};b.prototype.fb=function(a,b){taskContext=this.L.createTaskContext(a,{onDataReadyToProcess:function(d){if(b.aa)throw"AsyncProxy.DependencyWorkers: already terminated";b.M?(b.xa=d,b.va=!0):c.Ha(b,d,a)},onTerminated:b.tb,registerTaskDependency:b.vb});b.ba=taskContext;if(!taskContext.statusUpdated)throw"AsyncProxy.DependencyWorkers: missing taskContext.statusUpdated()";
if(!taskContext.onDependencyTaskResult)throw"AsyncProxy.DependencyWorkers: missing taskContext.onDependencyTaskResult()";var c=this};b.prototype.Ha=function(a,b,c){var d=this,g;g=0<d.oa.length?d.oa.pop():new z(d.cb,d.Xa,d.Wa);a.M=!0;a.N();g.Ia("start",[b,c],{isReturnPromise:!0}).then(function(b){a.Na=!0;a.Pa=b;for(var d=a.u,e=d.j();null!=e;){var g=d.l(e),e=d.m(e);g.h.onData(b,c)}return b})["catch"](function(a){console.log("Error in DependencyWorkers' worker: "+a);return a}).then(function(b){d.oa.push(g);
if(a.va){var c=a.xa;a.va=!1;a.xa=null;d.Ha(a,c);return b}a.M=!1;a.N()})};c.s(G,"DependencyWorkers");return b}var J=G();var I=function K(){function c(a,c){this.a=a;this.ga=0;this.h=c;this.Y=a.u.add(this)}c.prototype.ra=function(){return this.a.Na};c.prototype.qa=function(){return this.a.Pa};c.prototype.Sa=function(a){if(!this.Y)throw"AsyncProxy.DependencyWorkers: Already unregistered";a=a>this.a.D?a:this.ga<this.a.D?this.a.D:this.a.Ra();this.a.Ta(a)};c.prototype.unregister=function(){if(!this.Y)throw"AsyncProxy.DependencyWorkers: Already unregistered";this.a.u.remove(this.Y);this.Y=null;if(0==this.a.u.i)this.a.aa||
(this.a.ended(),this.a.N());else if(this.ga===this.a.D){var a=this.a.Ra();this.a.Ta(a)}};asyncProxyScriptBlob.s(K,"DependencyWorkersTaskHandle");return c}();var H=function(){function b(){this.aa=!1;this.D=0;this.Pa=null;this.va=this.M=this.Na=!1;this.ba=this.xa=null;this.u=new E;this.tb=this.ab.bind(this);this.vb=this.bb.bind(this);this.Ba=0;this.o=this.ha=this.Fa=this.Ea=null}b.prototype.sa=function(b,a,e,f){this.Ea=b;this.Fa=a;this.ha=e;this.o=new F(f)};b.prototype.ended=function(){for(var b=this.o.j();null!=b;){var a=this.o.l(b).O,b=this.o.m(b);a.unregister()}for(b=this.u.j();null!=b;)if(a=this.u.l(b),b=this.u.m(b),a.h.onTerminated)a.h.onTerminated();
this.u.clear();this.o=[];this.Fa.remove(this.ha);this.ha=null};b.prototype.Ta=function(b){if(this.D!==b){this.D=b;this.N();for(var a=this.o.j();null!=a;){var e=this.o.l(a).O,a=this.o.m(a);e.Sa(b)}}};b.prototype.N=function(){this.ba.statusUpdated({priority:this.D,hasListeners:0<this.u.i,isIdle:!this.M,terminatedDependsTasks:this.Ba,dependsTasks:this.o.i})};b.prototype.Ra=function(){for(var b=this.u,a=b.j(),e=0;null!=a;)e=b.l(a).ga,a=b.m(a);return e};b.prototype.ab=function(){if(this.aa)throw"AsyncProxy.DependencyWorkers: already terminated";
if(this.M)throw"AsyncProxy.DependencyWorkers: Cannot terminate while task is processing. Wait for statusUpdated() callback with isIdle == true";this.aa=!0;this.ended()};b.prototype.Ya=function(){++this.Ba;this.N()};b.prototype.bb=function(b){function a(a){f.ba.onDependencyTaskResult(a,b);d=!0}var e=this.o.za(b,function(){return{O:null}});if(!e.ua)throw"AsyncProxy.DependencyWorkers: Cannot add task dependency twice";var f=this,d=!1,g=!1;e.value.O=this.Ea.ya(b,{onData:a,onTerminated:function(){if(g)throw"AsyncProxy.DependencyWorkers: Double termination";
g=!0;f.Ya()}});setTimeout(function(){!d&&e.value.O.ra()&&a(e.O.qa())})};return b}();function L(){function b(a,b,c,d){this.gb=a;this.I=b;this.L=c;this.h=d;this.W=null;this.Ga=[];this.Da=[];this.A=1;this.Aa();for(a=0;a<b.length;++a)d.registerTaskDependency(b[a])}var c=self.asyncProxyScriptBlob;Object.defineProperty(b.prototype,"dependsOnTasks",{get:function(){return this.I}});b.prototype.sb=function(a,b){if(1!==this.A)throw"AsyncProxy.PromiseTask: Internal Error: not waiting for tasks depends on";if(null===this.W){this.W=new F(this.L);for(var c=0;c<this.I.length;++c)this.W.za(this.I[c],
function(){return c})}var d=this.W.Ma(b);if(null===d)throw"AsyncProxy.PromiseTask: Task is not depends on key";this.Ga[d]=a;this.Da[d]||(this.Da[d]=!0)};b.prototype.Db=function(a){!a.hasListeners&&a.isIdle?this.ma("No listeners"):1===this.A?this.Aa(a):a.isIdle&&3===this.A&&this.ma()};b.prototype.Aa=function(a){var b=0;a&&(b=a.terminatedDependsTasks);if(b===this.I.length){var c=this;this.A=2;this.L.preWorkerProcess(this.Ga,this.I,this.gb).then(function(a){4!==c.A&&(c.A=3,c.h.onDataReadyToProcess(a))})["catch"](function(a){c.ma(a)})}};
b.prototype.ma=function(a){4!==this.A&&(this.A=4,this.h.onTerminated(a))};c.s(L,"PromiseTask");return b}var M=L();function N(b){function c(c,d,e,h){b.call(this,c,d,e,a(h));if(!h.getDependsOnTasks)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.getDependsOnTasks() method";if(!h.preWorkerProcess)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.preWorkerProcess() method";if(!h.getHashCode)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.getHashCode() method";if(!h.isEqual)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.isEqual() method";}function a(a){return{V:a,
createTaskContext:function(a,b){var c=this.V.getDependsOnTasks(a);return new M(a,c,this.V,b)},getHashCode:function(a){return this.V.getHashCode(a)},isEqual:function(a,b){return this.V.isEqual(a,b)}}}var e=self.asyncProxyScriptBlob;c.prototype=Object.create(b.prototype);c.prototype.Cb=function(a){var b=this;return new Promise(function(c,e){var n=b.ya(a,{onData:function(a){k=!0;t=a},onTerminated:function(){k?c(t):e("AsyncProxy.PromiseDependencyWorkers: Internal error - task terminated but no data returned")}}),
k=n.ra(),t;k&&(t=n.qa())})};e.s(N,"PromiseDependencyWorkers",null,"DependencyWorkers");return c}var O=N(J);function P(){asyncProxyScriptBlob.s(P,"ExportAsyncProxySymbols");asyncProxyScriptBlob.B("ExportAsyncProxySymbols(SubWorkerEmulationForChrome, AsyncProxySlaveSingleton, AsyncProxyMaster, ScriptsToImportPool, DependencyWorkers, DependencyWorkersTaskHandle, PromiseTask, PromiseDependencyWorkers);");asyncProxyScriptBlob.B("self['AsyncProxy']['AsyncProxySlaveSingleton'] = AsyncProxySlaveSingleton;");asyncProxyScriptBlob.B("self['AsyncProxy']['AsyncProxyMaster'] = AsyncProxyMaster;");asyncProxyScriptBlob.B("self['AsyncProxy']['ScriptsToImportPool'] = ScriptsToImportPool;");
asyncProxyScriptBlob.B("self['AsyncProxy']['DependencyWorkers'] = DependencyWorkers;");asyncProxyScriptBlob.B("self['AsyncProxy']['PromiseTask'] = PromiseTask;");asyncProxyScriptBlob.B("self['AsyncProxy']['PromiseDependencyWorkers'] = PromiseDependencyWorkers;");return function(b,c,a,e,f,d,g,h){self.AsyncProxy=self.AsyncProxy||{};b.prototype.postMessage=b.prototype.postMessage;b.prototype.terminate=b.prototype.terminate;c.setSlaveSideCreator=c.Ab;c.setBeforeOperationListener=c.zb;c.sendUserDataToMaster=
c.yb;c.wrapPromiseFromSlaveSide=c.Va;c.wrapCallbackFromSlaveSide=c.Ua;a.prototype.setUserDataHandler=a.prototype.Bb;a.prototype.terminate=a.prototype.terminate;a.prototype.callFunction=a.prototype.Ia;a.prototype.wrapCallback=a.prototype.Gb;a.prototype.freeCallback=a.prototype.Ka;a.getEntryUrl=a.La;e.prototype.addScriptFromErrorWithStackTrace=e.prototype.ib;e.prototype.getScriptsForWorkerImport=e.prototype.mb;f.prototype.startTask=f.prototype.ya;f.prototype.getTaskContext=f.prototype.nb;d.prototype.hasData=
d.prototype.ra;d.prototype.getLastData=d.prototype.qa;d.prototype.setPriority=d.prototype.Sa;d.prototype.unregister=d.prototype.unregister;g.prototype.onDependencyTaskResult=g.prototype.sb;g.prototype.statusUpdated=g.prototype.Db;h.prototype.startTaskPromise=h.prototype.Cb}}P()(x,C,z,B,J,I,M,O);self.AsyncProxy.AsyncProxySlaveSingleton=C;self.AsyncProxy.AsyncProxyMaster=z;self.AsyncProxy.ScriptsToImportPool=B;self.AsyncProxy.DependencyWorkers=J;self.AsyncProxy.PromiseTask=M;
self.AsyncProxy.PromiseDependencyWorkers=O;
