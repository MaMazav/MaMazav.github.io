var v=u();self.asyncProxyScriptBlob=new v;
function u(){function b(){this.g=["'use strict';"];this.da=this.H=null;this.cb={};this.s(u,"BlobScriptGenerator");this.B("var asyncProxyScriptBlob = new BlobScriptGenerator();")}b.prototype.s=function(c,a,e,b){if(this.H)throw Error("Cannot add member to AsyncProxyScriptBlob after blob was used");a&&(e?(this.cb[e]=!0,this.g.push(e),this.g.push(".")):this.g.push("var "),this.g.push(a),this.g.push(" = "));this.g.push("(");this.g.push(c.toString());this.g.push(")(");this.g.push(b||"");this.g.push(");")};
b.prototype.B=function(c){if(this.H)throw Error("Cannot add statement to AsyncProxyScriptBlob after blob was used");this.g.push(c)};b.prototype.getBlob=function(){this.H||(this.H=new Blob(this.g,{type:"application/javascript"}));return this.H};b.prototype.ob=function(){this.da||(this.da=URL.createObjectURL(this.getBlob()));return this.da};return b};function w(){function b(e){if(null===a)throw"AsyncProxy internal error: SubWorkerEmulationForChrome not initialized";this.X=++c;a[this.X]=this;self.postMessage({type:"subWorkerCtor",F:this.X,zb:e})}var c=0,a=null;b.ta=function(c){a=c};b.prototype.postMessage=function(a,c){self.postMessage({type:"subWorkerPostMessage",F:this.X,data:a},c)};b.prototype.terminate=function(a,c){self.postMessage({type:"subWorkerTerminate",F:this.X},c)};self.asyncProxyScriptBlob.s(w,"SubWorkerEmulationForChrome");return b}
var x=w();function y(){function b(r,e,f,d){var l=this;d=d||{};var p=c.toString(),p=p.replace("SCRIPT_PLACEHOLDER",g.ob()),p=URL.createObjectURL(new Blob(["(",p,")()"],{type:"application/javascript"}));l.h=[];l.J=[];l.la=[];l.ma=[];l.$=new Worker(p);l.$.onmessage=function(c){a(l,c)};l.oa=null;l.T=0;l.Da=d.functionsBufferSize||5;l.ja=[];l.$.postMessage({qa:"ctor",Ab:r,nb:e,C:f,b:++h,Pa:!1,ub:b.Ma()})}function c(){importScripts("SCRIPT_PLACEHOLDER");AsyncProxy.AsyncProxySlave=self.AsyncProxy.AsyncProxySlaveSingleton;
AsyncProxy.AsyncProxySlave.bb()}function a(a,c){var b=c.data.b;switch(c.data.type){case "functionCalled":--a.T;d(a);break;case "promiseResult":var f=a.J[b];delete a.J[b];f.resolve(c.data.result);break;case "promiseFailure":f=a.J[b];delete a.J[b];f.reject(c.data.reason);break;case "userData":null!==a.oa&&a.oa(c.data.Ib);break;case "callback":b=a.h[c.data.b];if(void 0===b)throw"Unexpected message from SlaveWorker of callback ID: "+c.data.b+". Maybe should indicate isMultipleTimesCallback = true on creation?";
b.ua||a.La(a.h[c.data.b]);null!==b.Ka&&b.Ka.apply(null,c.data.C);break;case "subWorkerCtor":var b=new Worker(c.data.zb),g=c.data.F;a.la[g]=b;a.ma.push(b);b.onmessage=function(c){e(a,c.ports,!1,{qa:"subWorkerOnMessage",F:g,data:c.data})};break;case "subWorkerPostMessage":b=a.la[c.data.F];b.postMessage(c.data.data);break;case "subWorkerTerminate":b=a.la[c.data.F];b.terminate();break;default:throw"Unknown message from AsyncProxySlave of type: "+c.data.type;}}function e(a,c,b,e){a.T>=a.Da?a.ja.push({Hb:c,
sb:b,message:e}):f(a,c,b,e)}function f(a,c,b,e){b&&++a.T;a.$.postMessage(e,c)}function d(a){for(;a.T<a.Da&&0<a.ja.length;){var c=a.ja.shift();f(a,c.Hb,c.sb,c.message)}}var g=self.asyncProxyScriptBlob,h=0,m=!1,n=function(){var a=location.href,c=a.lastIndexOf("/");0<=c&&(a=a.substring(0,c));return a}();b.prototype.Eb=function(a){this.oa=a};b.prototype.terminate=function(){this.$.terminate();for(var a=0;a<this.ma.length;++a)this.ma[a].terminate()};b.prototype.Ja=function(a,c,b){b=b||{};var d=!!b.isReturnPromise,
g=b.transferables,p=b.pathsToTransferablesInPromiseResult,k=++h,m=null,n=this;d&&(m=new Promise(function(a,c){n.J[k]={resolve:a,reject:c}}));(b.isSendImmediately?f:e)(this,g,!0,{qa:a,C:c||[],b:k,Pa:d,xb:p});if(d)return m};b.prototype.Jb=function(a,c,b){b=b||{};var e=++h;c={tb:!0,ua:!!b.isMultipleTimeCallback,b:e,mb:c,Sa:b.pathsToTransferables};this.h[e]={ua:!!b.isMultipleTimeCallback,b:e,Ka:a,Sa:b.pathsToTransferables};return c};b.prototype.La=function(a){delete this.h[a.b]};b.Ma=function(){m=!0;
return n};b.hb=function(a){if(n!==a&&m)throw"Previous values returned from getMasterEntryUrl is wrong. Avoid calling it within the slave c`tor";n=a};g.s(y,"AsyncProxyMaster");return b}var z=y();function A(){function b(){var a;try{for(var c=m.split("."),b=self,d=0;d<c.length;++d)b=b[c[d]];var c=b,f=[null].concat(e(arguments));a=new (Function.prototype.bind.apply(c,f))}catch(g){throw Error("Failed locating class name "+m+": "+g);}return a}function c(a,c){if(void 0!==a){for(var b=Array(a.length),e=0;e<a.length;++e){for(var d=a[e],f=c,g=0;g<d.length;++g)f=f[d[g]];b[e]=f}return b}}function a(a){var c=a.data.qa,e=a.data.C,d=a.data.b,l=a.data.Pa,n=a.data.xb;switch(c){case "ctor":self.AsyncProxy.AsyncProxyMaster.hb(a.data.ub);
d=a.data.Ab;m=a.data.nb;for(var k=0;k<d.length;++k)importScripts(d[k]);g=b.apply(null,e);return;case "subWorkerOnMessage":h[a.data.F].onmessage({data:a.data.data});return}e=Array(a.data.C.length);for(k=0;k<a.data.C.length;++k){var q=a.data.C[k];void 0!==q&&null!==q&&q.tb&&(q=f.Xa(q));e[k]=q}for(var k=g,t;k&&!(t=g[c]);)k=k.__proto__;if(!t)throw"AsyncProxy error: could not find function "+t;e=t.apply(g,e);l&&f.Ya(d,e,n);self.postMessage({type:"functionCalled",b:a.data.b,result:null})}function e(a){for(var c=
Array(a.length),b=0;b<a.length;++b)c[b]=a[b];return c}var f={},d=null,g,h={},m;f.bb=function(){self.onmessage=a};f.Db=function(a){b=a};f.Cb=function(a){d=a};f.Bb=function(a){self.postMessage({type:"userData",Ib:a})};f.Ya=function(a,b,e){b.then(function(b){var d=c(e,b);self.postMessage({type:"promiseResult",b:a,result:b},d)})["catch"](function(c){self.postMessage({type:"promiseFailure",b:a,reason:c})})};f.Xa=function(a){var b=!1;return function(){if(b)throw"Callback is called twice but isMultipleTimeCallback = false";
var f=e(arguments);if(null!==d)try{d.call(g,"callback",a.mb,f)}catch(h){console.log("AsyncProxySlave.beforeOperationListener has thrown an exception: "+h)}var m=c(a.Sa,f);self.postMessage({type:"callback",b:a.b,C:f},m);a.ua||(b=!0)}};f.fa=function(){return B.fa(Error())};if(void 0===self.Worker){var n=self.SubWorkerEmulationForChrome;n.ta(h);self.Worker=n}self.asyncProxyScriptBlob.s(A,"AsyncProxySlaveSingleton");return f}var C=A();function D(){function b(){this.ka={};this.K=null}b.prototype.lb=function(c){c=b.fa(c);this.ka[c]||(this.ka[c]=!0,this.K=null)};b.prototype.pb=function(){if(null===this.K){this.K=[];for(var c in this.ka)this.K.push(c)}return this.K};b.fa=function(c){var a=c.stack.trim(),b=/at (|[^ ]+ \()([^ ]+):\d+:\d+/.exec(a);if(b&&""!==b[2])return b[2];if((b=(new RegExp(/.+\/(.*?):\d+(:\d+)*$/)).exec(a))&&""!==b[1])return b[1];if(void 0!=c.fileName)return c.fileName;throw"ImageDecoderFramework.js: Could not get current script URL";
};self.asyncProxyScriptBlob.s(D,"ScriptsToImportPool");return b}var B=D();var E=function(){function b(){this.clear()}b.prototype.clear=function(){this.ea={w:null,U:this};this.R={v:null,U:this};this.i=0;this.R.w=this.ea;this.ea.v=this.R};b.prototype.add=function(c,a){if(null===a||void 0===a)a=this.R;this.Z(a);++this.i;var b={kb:c,v:a,w:a.w,U:this};b.w.v=b;return a.w=b};b.prototype.remove=function(c){this.Z(c);--this.i;c.w.v=c.v;c.v.w=c.w;c.U=null};b.prototype.l=function(c){this.Z(c);return c.kb};b.prototype.j=function(){return this.m(this.ea)};b.prototype.m=function(c){this.Z(c);
return c.v===this.R?null:c.v};b.prototype.Z=function(c){if(c.U!==this)throw"iterator must be of the current LinkedList";};return b}();var F=function(){function b(c){this.S=[];this.G=new E;this.P=c;this.i=0}b.prototype.Na=function(c){var a=this.P.getHashCode(c),a=this.S[a];if(!a)return null;for(var a=a.list,b=a.j();null!==b;){var f=a.l(b);if(this.P.isEqual(f.key,c))return f.value;b=a.m(b)}return null};b.prototype.l=function(c){return c.c.list.l(c.f).value};b.prototype.Aa=function(c,a){var b=this.P.getHashCode(c),f=this.S[b];f||(f={rb:b,list:new E,xa:null},f.xa=this.G.add(f),this.S[b]=f);b={c:f,f:null};for(b.f=f.list.j();null!==b.f;){var d=
f.list.l(b.f);if(this.P.isEqual(d.key,c))return{iterator:b,va:!1,value:d.value};b.f=f.list.m(b.f)}d=a();b.f=f.list.add({key:c,value:d});++this.i;return{iterator:b,va:!0,value:d}};b.prototype.remove=function(c){var a=c.c.list.i;c.c.list.remove(c.f);var b=c.c.list.i;this.i+=b-a;0===b&&(this.G.remove(c.c.xa),delete this.S[c.c.rb])};b.prototype.j=function(){var c=this.G.j(),a=null,b=null;null!==c&&(a=this.G.l(c),b=a.list.j());return null===b?null:{c:a,f:b}};b.prototype.m=function(c){for(var a={c:c.c,
f:c.c.list.m(c.f)};null===a.f;){var b=this.G.m(c.c.xa);if(null===b)return null;a.c=this.G.l(b);a.f=a.c.list.j()}return a};return b}();function G(){function b(a,c,b,d){this.L=d;this.$a=c;this.Za=b;this.gb=a;this.ga=new F(d);this.pa=[];if(!d.createTaskContext)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.createTaskContext() method";if(!d.getHashCode)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.getHashCode() method";if(!d.isEqual)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.isEqual() method";}var c=self.asyncProxyScriptBlob;b.prototype.za=function(a,c){var b=this.ga.Aa(a,function(){return new H}),
d=b.value,g=new I(d,c);b.va&&(d.ta(a,this,this.ga,b.iterator,this.L),this.ib(d));return g};b.prototype.qb=function(a){a=this.ga.Na(a);return null===a?null:a.ba};b.prototype.ib=function(a){taskContext=this.L.createTaskContext(a.ca,{onDataReadyToProcess:function(b,d){if(a.aa)throw"AsyncProxy.DependencyWorkers: already terminated";a.M?(a.ya=b,a.wa=!0,a.Ta=d):c.Ia(a,b,d)},onTerminated:a.wb,registerTaskDependency:a.yb});a.ba=taskContext;if(!taskContext.statusUpdated)throw"AsyncProxy.DependencyWorkers: missing taskContext.statusUpdated()";
if(!taskContext.onDependencyTaskResult)throw"AsyncProxy.DependencyWorkers: missing taskContext.onDependencyTaskResult()";var c=this};b.prototype.Ia=function(a,c,b){var d=this;if(b)a.Ra(c);else{var g;g=0<d.pa.length?d.pa.pop():new z(d.gb,d.$a,d.Za);a.M=!0;a.N();g.Ja("start",[c,a.ca],{isReturnPromise:!0}).then(function(c){a.Ra(c);return c})["catch"](function(a){console.log("Error in DependencyWorkers' worker: "+a);return a}).then(function(c){d.pa.push(g);a.M=!1;a.N();if(a.wa){var b=a.ya;a.wa=!1;a.ya=
null;d.Ia(a,b,a.Ta);return c}})}};c.s(G,"DependencyWorkers");return b}var J=G();var I=function K(){function c(a,c){this.a=a;this.ha=0;this.h=c;this.Y=a.u.add(this)}c.prototype.sa=function(){return this.a.Oa};c.prototype.ra=function(){return this.a.Qa};c.prototype.Va=function(a){if(!this.Y)throw"AsyncProxy.DependencyWorkers: Already unregistered";a=a>this.a.D?a:this.ha<this.a.D?this.a.D:this.a.Ua();this.a.Wa(a)};c.prototype.unregister=function(){if(!this.Y)throw"AsyncProxy.DependencyWorkers: Already unregistered";this.a.u.remove(this.Y);this.Y=null;if(0==this.a.u.i)this.a.aa||
(this.a.ended(),this.a.N());else if(this.ha===this.a.D){var a=this.a.Ua();this.a.Wa(a)}};asyncProxyScriptBlob.s(K,"DependencyWorkersTaskHandle");return c}();var H=function(){function b(){this.aa=!1;this.D=0;this.Qa=null;this.wa=this.M=this.Oa=!1;this.ya=null;this.Ta=!1;this.ba=null;this.u=new E;this.wb=this.eb.bind(this);this.yb=this.fb.bind(this);this.ca=null;this.Ca=0;this.o=this.ia=this.Ga=this.Fa=null}b.prototype.ta=function(c,a,b,f,d){this.ca=c;this.Fa=a;this.Ga=b;this.ia=f;this.o=new F(d)};b.prototype.ended=function(){for(var c=this.o.j();null!=c;){var a=this.o.l(c).O,c=this.o.m(c);a.unregister()}for(c=this.u.j();null!=c;)if(a=this.u.l(c),c=this.u.m(c),
a.h.onTerminated)a.h.onTerminated();this.u.clear();this.o=[];this.Ga.remove(this.ia);this.ia=null};b.prototype.Wa=function(c){if(this.D!==c){this.D=c;this.N();for(var a=this.o.j();null!=a;){var b=this.o.l(a).O,a=this.o.m(a);b.Va(c)}}};b.prototype.N=function(){this.ba.statusUpdated({priority:this.D,hasListeners:0<this.u.i,isIdle:!this.M,terminatedDependsTasks:this.Ca,dependsTasks:this.o.i})};b.prototype.Ua=function(){for(var c=this.u,a=c.j(),b=0;null!=a;)b=c.l(a).ha,a=c.m(a);return b};b.prototype.Ra=
function(b){this.Oa=!0;this.Qa=b;for(var a=this.u,e=a.j();null!=e;){var f=a.l(e),e=a.m(e);f.h.onData(b,this.ca)}};b.prototype.eb=function(){if(this.aa)throw"AsyncProxy.DependencyWorkers: already terminated";if(this.M)throw"AsyncProxy.DependencyWorkers: Cannot terminate while task is processing. Wait for statusUpdated() callback with isIdle == true";this.aa=!0;this.ended()};b.prototype.ab=function(){++this.Ca;this.N()};b.prototype.fb=function(b){function a(a){f.ba.onDependencyTaskResult(a,b);d=!0}
var e=this.o.Aa(b,function(){return{O:null}});if(!e.va)throw"AsyncProxy.DependencyWorkers: Cannot add task dependency twice";var f=this,d=!1,g=!1;e.value.O=this.Fa.za(b,{onData:a,onTerminated:function(){if(g)throw"AsyncProxy.DependencyWorkers: Double termination";g=!0;f.ab()}});setTimeout(function(){!d&&e.value.O.sa()&&a(e.O.ra())})};return b}();function L(){function b(a,b,c,d){this.jb=a;this.I=b;this.L=c;this.h=d;this.W=null;this.Ha=[];this.Ea=[];this.A=1;this.Ba();for(a=0;a<b.length;++a)d.registerTaskDependency(b[a])}var c=self.asyncProxyScriptBlob;Object.defineProperty(b.prototype,"dependsOnTasks",{get:function(){return this.I}});b.prototype.vb=function(a,b){if(1!==this.A)throw"AsyncProxy.PromiseTask: Internal Error: not waiting for tasks depends on";if(null===this.W){this.W=new F(this.L);for(var c=0;c<this.I.length;++c)this.W.Aa(this.I[c],
function(){return c})}var d=this.W.Na(b);if(null===d)throw"AsyncProxy.PromiseTask: Task is not depends on key";this.Ha[d]=a;this.Ea[d]||(this.Ea[d]=!0)};b.prototype.Gb=function(a){!a.hasListeners&&a.isIdle?this.na("No listeners"):1===this.A?this.Ba(a):a.isIdle&&3===this.A&&this.na()};b.prototype.Ba=function(a){var b=0;a&&(b=a.terminatedDependsTasks);if(b===this.I.length){var c=this;this.A=2;this.L.preWorkerProcess(this.Ha,this.I,this.jb).then(function(a){4!==c.A&&(c.A=3,c.h.onDataReadyToProcess(a))})["catch"](function(a){c.na(a)})}};
b.prototype.na=function(a){4!==this.A&&(this.A=4,this.h.onTerminated(a))};c.s(L,"PromiseTask");return b}var M=L();function N(b){function c(c,d,e,h){b.call(this,c,d,e,a(h));if(!h.getDependsOnTasks)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.getDependsOnTasks() method";if(!h.preWorkerProcess)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.preWorkerProcess() method";if(!h.getHashCode)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.getHashCode() method";if(!h.isEqual)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.isEqual() method";}function a(a){return{V:a,
createTaskContext:function(a,b){var c=this.V.getDependsOnTasks(a);return new M(a,c,this.V,b)},getHashCode:function(a){return this.V.getHashCode(a)},isEqual:function(a,b){return this.V.isEqual(a,b)}}}var e=self.asyncProxyScriptBlob;c.prototype=Object.create(b.prototype);c.prototype.Fb=function(a){var b=this;return new Promise(function(c,e){var m=b.za(a,{onData:function(a){n=!0;r=a},onTerminated:function(){n?c(r):e("AsyncProxy.PromiseDependencyWorkers: Internal error - task terminated but no data returned")}}),
n=m.sa(),r;n&&(r=m.ra())})};e.s(N,"PromiseDependencyWorkers",null,"DependencyWorkers");return c}var O=N(J);function P(){asyncProxyScriptBlob.s(P,"ExportAsyncProxySymbols");asyncProxyScriptBlob.B("ExportAsyncProxySymbols(SubWorkerEmulationForChrome, AsyncProxySlaveSingleton, AsyncProxyMaster, ScriptsToImportPool, DependencyWorkers, DependencyWorkersTaskHandle, PromiseTask, PromiseDependencyWorkers);");asyncProxyScriptBlob.B("self['AsyncProxy']['AsyncProxySlaveSingleton'] = AsyncProxySlaveSingleton;");asyncProxyScriptBlob.B("self['AsyncProxy']['AsyncProxyMaster'] = AsyncProxyMaster;");asyncProxyScriptBlob.B("self['AsyncProxy']['ScriptsToImportPool'] = ScriptsToImportPool;");
asyncProxyScriptBlob.B("self['AsyncProxy']['DependencyWorkers'] = DependencyWorkers;");asyncProxyScriptBlob.B("self['AsyncProxy']['PromiseTask'] = PromiseTask;");asyncProxyScriptBlob.B("self['AsyncProxy']['PromiseDependencyWorkers'] = PromiseDependencyWorkers;");return function(b,c,a,e,f,d,g,h){self.AsyncProxy=self.AsyncProxy||{};b.prototype.postMessage=b.prototype.postMessage;b.prototype.terminate=b.prototype.terminate;c.setSlaveSideCreator=c.Db;c.setBeforeOperationListener=c.Cb;c.sendUserDataToMaster=
c.Bb;c.wrapPromiseFromSlaveSide=c.Ya;c.wrapCallbackFromSlaveSide=c.Xa;a.prototype.setUserDataHandler=a.prototype.Eb;a.prototype.terminate=a.prototype.terminate;a.prototype.callFunction=a.prototype.Ja;a.prototype.wrapCallback=a.prototype.Jb;a.prototype.freeCallback=a.prototype.La;a.getEntryUrl=a.Ma;e.prototype.addScriptFromErrorWithStackTrace=e.prototype.lb;e.prototype.getScriptsForWorkerImport=e.prototype.pb;f.prototype.startTask=f.prototype.za;f.prototype.getTaskContext=f.prototype.qb;d.prototype.hasData=
d.prototype.sa;d.prototype.getLastData=d.prototype.ra;d.prototype.setPriority=d.prototype.Va;d.prototype.unregister=d.prototype.unregister;g.prototype.onDependencyTaskResult=g.prototype.vb;g.prototype.statusUpdated=g.prototype.Gb;h.prototype.startTaskPromise=h.prototype.Fb}}P()(x,C,z,B,J,I,M,O);self.AsyncProxy.AsyncProxySlaveSingleton=C;self.AsyncProxy.AsyncProxyMaster=z;self.AsyncProxy.ScriptsToImportPool=B;self.AsyncProxy.DependencyWorkers=J;self.AsyncProxy.PromiseTask=M;
self.AsyncProxy.PromiseDependencyWorkers=O;
