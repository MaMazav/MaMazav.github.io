var t=r();self.asyncProxyScriptBlob=new t;
function r(){function a(){this.h=["'use strict';"];this.$=this.B=null;this.f(r,"BlobScriptGenerator");this.m("var asyncProxyScriptBlob = new BlobScriptGenerator();")}a.prototype.f=function(c,b){if(this.B)throw Error("Cannot add member to AsyncProxyScriptBlob after blob was used");b&&(this.h.push("var "),this.h.push(b),this.h.push(" = "));this.h.push("(");this.h.push(c.toString());this.h.push(")();")};a.prototype.m=function(c){if(this.B)throw Error("Cannot add statement to AsyncProxyScriptBlob after blob was used");this.h.push(c)};
a.prototype.getBlob=function(){this.B||(this.B=new Blob(this.h,{type:"application/javascript"}));return this.B};a.prototype.eb=function(){this.$||(this.$=URL.createObjectURL(this.getBlob()));return this.$};return a};function u(){function a(e){if(null===b)throw"AsyncProxy internal error: SubWorkerEmulationForChrome not initialized";this.T=++c;b[this.T]=this;self.postMessage({type:"subWorkerCtor",v:this.T,pb:e})}var c=0,b=null;a.hb=function(c){b=c};a.prototype.postMessage=function(b,c){self.postMessage({type:"subWorkerPostMessage",v:this.T,data:b},c)};a.prototype.terminate=function(b,c){self.postMessage({type:"subWorkerTerminate",v:this.T},c)};self.asyncProxyScriptBlob.f(u,"SubWorkerEmulationForChrome");return a}
var v=u();function w(){function a(M,e,f,d){var m=this;d=d||{};var h=c.toString(),h=h.replace("SCRIPT_PLACEHOLDER",g.eb()),h=URL.createObjectURL(new Blob(["(",h,")()"],{type:"application/javascript"}));m.c=[];m.F=[];m.fa=[];m.ga=[];m.W=new Worker(h);m.W.onmessage=function(c){b(m,c)};m.ia=null;m.O=0;m.qa=d.functionsBufferSize||5;m.da=[];m.W.postMessage({ka:"ctor",qb:M,bb:e,u:f,b:++n,Ha:!1,kb:a.Ba()})}function c(){importScripts("SCRIPT_PLACEHOLDER");AsyncProxy.AsyncProxySlave=self.AsyncProxy.AsyncProxySlaveSingleton;
AsyncProxy.AsyncProxySlave.Ta()}function b(b,c){var a=c.data.b;switch(c.data.type){case "functionCalled":--b.O;d(b);break;case "promiseResult":var f=b.F[a];delete b.F[a];f.resolve(c.data.result);break;case "promiseFailure":f=b.F[a];delete b.F[a];f.reject(c.data.reason);break;case "userData":null!==b.ia&&b.ia(c.data.Ab);break;case "callback":a=b.c[c.data.b];if(void 0===a)throw"Unexpected message from SlaveWorker of callback ID: "+c.data.b+". Maybe should indicate isMultipleTimesCallback = true on creation?";
a.la||b.Aa(b.c[c.data.b]);null!==a.ya&&a.ya.apply(null,c.data.u);break;case "subWorkerCtor":var a=new Worker(c.data.pb),g=c.data.v;b.fa[g]=a;b.ga.push(a);a.onmessage=function(c){e(b,c.ports,!1,{ka:"subWorkerOnMessage",v:g,data:c.data})};break;case "subWorkerPostMessage":a=b.fa[c.data.v];a.postMessage(c.data.data);break;case "subWorkerTerminate":a=b.fa[c.data.v];a.terminate();break;default:throw"Unknown message from AsyncProxySlave of type: "+c.data.type;}}function e(b,c,a,e){b.O>=b.qa?b.da.push({zb:c,
ib:a,message:e}):f(b,c,a,e)}function f(b,c,a,e){a&&++b.O;b.W.postMessage(e,c)}function d(b){for(;b.O<b.qa&&0<b.da.length;){var c=b.da.shift();f(b,c.zb,c.ib,c.message)}}var g=self.asyncProxyScriptBlob,n=0,h=!1,l=function(){var b=location.href,c=b.lastIndexOf("/");0<=c&&(b=b.substring(0,c));return b}();a.prototype.wb=function(b){this.ia=b};a.prototype.terminate=function(){this.W.terminate();for(var b=0;b<this.ga.length;++b)this.ga[b].terminate()};a.prototype.xa=function(b,c,a){a=a||{};var d=!!a.isReturnPromise,
g=a.transferables,h=a.pathsToTransferablesInPromiseResult,k=++n,l=null,q=this;d&&(l=new Promise(function(b,c){q.F[k]={resolve:b,reject:c}}));(a.isSendImmediately?f:e)(this,g,!0,{ka:b,u:c||[],b:k,Ha:d,ob:h});if(d)return l};a.prototype.Bb=function(b,c,a){a=a||{};var e=++n;c={jb:!0,la:!!a.isMultipleTimeCallback,b:e,ab:c,Ja:a.pathsToTransferables};this.c[e]={la:!!a.isMultipleTimeCallback,b:e,ya:b,Ja:a.pathsToTransferables};return c};a.prototype.Aa=function(b){delete this.c[b.b]};a.Ba=function(){h=!0;
return l};a.Wa=function(b){if(l!==b&&h)throw"Previous values returned from getMasterEntryUrl is wrong. Avoid calling it within the slave c`tor";l=b};g.f(w,"AsyncProxyMaster");return a}var x=w();function y(){function a(){var b;try{for(var c=h.split("."),a=self,f=0;f<c.length;++f)a=a[c[f]];var c=a,d=[null].concat(e(arguments));b=new (Function.prototype.bind.apply(c,d))}catch(g){throw Error("Failed locating class name "+h+": "+g);}return b}function c(b,c){if(void 0!==b){for(var a=Array(b.length),e=0;e<b.length;++e){for(var f=b[e],d=c,g=0;g<f.length;++g)d=d[f[g]];a[e]=d}return a}}function b(b){var c=b.data.ka,e=b.data.u,d=b.data.b,l=b.data.Ha,N=b.data.ob;switch(c){case "ctor":self.AsyncProxy.AsyncProxyMaster.Wa(b.data.kb);
d=b.data.qb;h=b.data.bb;for(var k=0;k<d.length;++k)importScripts(d[k]);g=a.apply(null,e);return;case "subWorkerOnMessage":n[b.data.v].onmessage({data:b.data.data});return}e=Array(b.data.u.length);for(k=0;k<b.data.u.length;++k){var p=b.data.u[k];void 0!==p&&null!==p&&p.jb&&(p=f.Oa(p));e[k]=p}for(var k=g,q;k&&!(q=g[c]);)k=k.__proto__;if(!q)throw"AsyncProxy error: could not find function "+q;e=q.apply(g,e);l&&f.Pa(d,e,N);self.postMessage({type:"functionCalled",b:b.data.b,result:null})}function e(b){for(var c=
Array(b.length),a=0;a<b.length;++a)c[a]=b[a];return c}var f={},d=null,g,n={},h;f.Ta=function(){self.onmessage=b};f.vb=function(b){a=b};f.sb=function(b){d=b};f.rb=function(b){self.postMessage({type:"userData",Ab:b})};f.Pa=function(b,a,e){a.then(function(a){var f=c(e,a);self.postMessage({type:"promiseResult",b:b,result:a},f)})["catch"](function(c){self.postMessage({type:"promiseFailure",b:b,reason:c})})};f.Oa=function(b){var a=!1;return function(){if(a)throw"Callback is called twice but isMultipleTimeCallback = false";
var f=e(arguments);if(null!==d)try{d.call(g,"callback",b.ab,f)}catch(h){console.log("AsyncProxySlave.beforeOperationListener has thrown an exception: "+h)}var l=c(b.Ja,f);self.postMessage({type:"callback",b:b.b,u:f},l);b.la||(a=!0)}};f.ba=function(){return z.ba(Error())};if(void 0===self.Worker){var l=self.SubWorkerEmulationForChrome;l.hb(n);self.Worker=l}self.asyncProxyScriptBlob.f(y,"AsyncProxySlaveSingleton");return f}var A=y();function B(){function a(){this.ea={};this.G=null}a.prototype.$a=function(c){c=a.ba(c);this.ea[c]||(this.ea[c]=!0,this.G=null)};a.prototype.gb=function(){if(null===this.G){this.G=[];for(var c in this.ea)this.G.push(c)}return this.G};a.ba=function(c){var b=c.stack.trim(),a=/at (|[^ ]+ \()([^ ]+):\d+:\d+/.exec(b);if(a&&""!==a[2])return a[2];if((a=(new RegExp(/.+\/(.*?):\d+(:\d+)*$/)).exec(b))&&""!==a[1])return a[1];if(void 0!=c.fileName)return c.fileName;throw"ImageDecoderFramework.js: Could not get current script URL";
};self.asyncProxyScriptBlob.f(B,"ScriptsToImportPool");return a}var z=B();var C=function(){function a(){this.clear()}a.prototype.clear=function(){this.aa={j:null,P:this};this.N={i:null,P:this};this.C=0;this.N.j=this.aa;this.aa.i=this.N};a.prototype.add=function(c,b){if(null===b||void 0===b)b=this.N;this.V(b);++this.C;var a={Za:c,i:b,j:b.j,P:this};a.j.i=a;return b.j=a};a.prototype.remove=function(c){this.V(c);--this.C;c.j.i=c.i;c.i.j=c.j;c.P=null};a.prototype.I=function(c){this.V(c);return c.Za};a.prototype.H=function(){return this.A(this.aa)};a.prototype.A=function(c){this.V(c);
return c.i===this.N?null:c.i};a.prototype.V=function(c){if(c.P!==this)throw"iterator must be of the current LinkedList";};return a}();var D=function(){function a(c){this.L=[];this.M=c}a.prototype.fb=function(c){var b=this.M.getHashCode(c),b=this.L[b];if(!b)return null;for(var a=b.H();null!==a;){var f=b.I(a);if(this.M.isEqual(f.key,c))return f.value;a=b.A(a)}return null};a.prototype.Na=function(c,b){var a=this.M.getHashCode(c),f=this.L[a];f||(f=new C,this.L[a]=f);a={Sa:a,sa:f,s:null};for(a.s=f.H();null!==a.s;){var d=f.I(a.s);if(this.M.isEqual(d.key,c))return{iterator:a,Ga:!1,value:d.value};a.s=f.A(a.s)}d=b();a.s=f.add({key:c,value:d});
return{iterator:a,Ga:!0,value:d}};a.prototype.remove=function(a){a.sa.remove(a.s);0===a.sa.C&&delete this.L[a.Sa]};return a}();function E(){function a(b,a,c,d){this.X=d;this.Ra=a;this.Qa=c;this.Va=b;this.ta=new D(d);this.ja=[];if(!d.createTaskContext)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.createTaskContext() method";if(!d.getHashCode)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.getHashCode() method";if(!d.isEqual)throw"AsyncProxy.DependencyWorkers: No workerInputRetreiver.isEqual() method";}var c=self.asyncProxyScriptBlob;a.prototype.Ma=function(b,a){var c=this.ta.Na(b,function(){return new F}),
d=c.value,g=new G(d,a);c.Ga&&(d.tb(this.ta,c.iterator),this.Xa(b,d));return g};a.prototype.Xa=function(b,a){taskContext=this.X.createTaskContext(b,{onDataReadyToProcess:function(c){if(a.Z)throw"AsyncProxy.DependencyWorkers: already terminated";a.J?(a.na=c,a.ma=!0):d.wa(a,c,b)},onTerminated:a.nb});a.oa=taskContext;var c=taskContext.dependsOnTasks;if(!taskContext.statusUpdated)throw"AsyncProxy.DependencyWorkers: missing taskContext.statusUpdated()";if(c&&!taskContext.onDependencyTaskResult)throw"AsyncProxy.DependencyWorkers: Cannot accept dependsOnTasks without onDependencyTaskResult in taskContext";
var d=this;a.Y=Array(c.length);for(var g=0;g<c.length;++g){a.Y[g]=!1;var n;(function(b){var g=!1;n=d.Ma(c[b],{onData:function(d){a.oa.onDependencyTaskResult(d,c[b]);a.Y[b]=!0},onTerminated:function(){if(g)throw"AsyncProxy.DependencyWorkers: Double termination";g=!0;a.cb()}})})(g);a.w.push(n)}setTimeout(function(){for(var b=0;b<a.w.length;++b){var d=a.w[b];if(!a.Y[b]&&d.Da())taskContext.onDependencyTaskResult(d.Ca(),c[b])}})};a.prototype.wa=function(b,a,c){var d=this,g;g=0<d.ja.length?d.ja.pop():new x(d.Va,
d.Ra,d.Qa);b.J=!0;b.K();g.xa("start",[a,c],{isReturnPromise:!0}).then(function(a){b.Ea=!0;b.Ia=a;for(var d=b.g,e=d.H();null!=e;){var g=d.I(e),e=d.A(e);g.c.onData(a,c)}return a})["catch"](function(b){console.log("Error in DependencyWorkers' worker: "+b);return b}).then(function(a){d.ja.push(g);if(b.ma){var c=b.na;b.ma=!1;b.na=null;d.wa(b,c);return a}b.J=!1;b.K()})};c.f(E,"DependencyWorkers");return a}var H=E();var G=function I(){function c(b,c){this.a=b;this.ca=0;this.c=c;this.U=b.g.add(this)}c.prototype.Da=function(){return this.a.Ea};c.prototype.Ca=function(){return this.a.Ia};c.prototype.ub=function(b){if(!this.U)throw"AsyncProxy.DependencyWorkers: Already unregistered";b=b>this.a.o?b:this.ca<this.a.o?this.a.o:this.a.Ka();this.a.La(b)};c.prototype.unregister=function(){if(!this.U)throw"AsyncProxy.DependencyWorkers: Already unregistered";this.a.g.remove(this.U);this.U=null;if(0==this.a.g.C)this.a.Z||
(this.a.ended(),this.a.K());else if(this.ca===this.a.o){var b=this.a.Ka();this.a.La(b)}};asyncProxyScriptBlob.f(I,"DependencyWorkersTaskHandle");return c}();var F=function(){function a(){this.Z=!1;this.o=0;this.Ia=null;this.ma=this.J=this.Ea=!1;this.oa=this.na=null;this.w=[];this.g=new C;this.Y=[];this.za=0;this.nb=this.mb.bind(this)}a.prototype.tb=function(a,b){this.Ua=a;this.ua=b};a.prototype.ended=function(){for(var a=this.w,b=0;b<a.length;++b)a[b].unregister();for(a=this.g.H();null!=a;)if(b=this.g.I(a),a=this.g.A(a),b.c.onTerminated)b.c.onTerminated();this.g.clear();this.w=[];this.Ua.remove(this.ua);this.ua=null};a.prototype.La=function(a){if(this.o!==
a){this.o=a;this.K();for(var b=this.w,e=0;e<b.length;++e)b[e].setPriority(a)}};a.prototype.K=function(){this.oa.statusUpdated({o:this.o,hasListeners:0<this.g.C,Fa:!this.J,yb:this.za})};a.prototype.Ka=function(){for(var a=this.g,b=a.H(),e=0;null!=b;)e=a.I(b).ca,b=a.A(b);return e};a.prototype.mb=function(){if(this.Z)throw"AsyncProxy.DependencyWorkers: already terminated";if(this.J)throw"AsyncProxy.DependencyWorkers: Cannot terminate while task is processing. Wait for statusUpdated() callback with isIdle == true";
this.Z=!0;this.ended()};a.prototype.cb=function(){++this.za;this.K()};return a}();function J(){function a(b,a,c,d){this.Ya=b;this.D=a;this.X=c;this.c=d;this.S=null;this.va=[];this.ra=[];this.l=1;this.pa()}var c=self.asyncProxyScriptBlob;Object.defineProperty(a.prototype,"dependsOnTasks",{get:function(){return this.D}});a.prototype.lb=function(b,a){if(1!==this.l)throw"AsyncProxy.PromiseTask: Internal Error: not waiting for tasks depends on";if(null===this.S){this.S=new D(this.X);for(var c=0;c<this.D.length;++c)this.S.Na(this.D[c],function(){return c})}var d=this.S.fb(a);if(null===
d)throw"AsyncProxy.PromiseTask: Task is not depends on key";this.va[d]=b;this.ra[d]||(this.ra[d]=!0)};a.prototype.xb=function(b){!b.hasListeners&&b.Fa?this.ha("No listeners"):1===this.l?this.pa(b):b.Fa&&3===this.l&&this.ha()};a.prototype.pa=function(b){var a=0;b&&(a=b.yb);if(a===this.D.length){var c=this;this.l=2;this.X.preWorkerProcess(this.va,this.D,this.Ya).then(function(a){4!==c.l&&(c.l=3,c.c.onDataReadyToProcess(a))})["catch"](function(a){c.ha(a)})}};a.prototype.ha=function(a){4!==this.l&&(this.l=
4,this.c.onTerminated(a))};c.f(J,"PromiseTask");return a}var K=J();function L(){function a(a,b,d,g){H.call(this,a,b,d,c(g));if(!g.getDependsOnTasks)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.getDependsOnTasks() method";if(!g.preWorkerProcess)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.preWorkerProcess() method";if(!g.getHashCode)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.getHashCode() method";if(!g.isEqual)throw"AsyncProxy.DependencyWorkers: No promiseInputRetreiver.isEqual() method";}function c(a){return{R:a,
createTaskContext:function(a,b){var c=this.R.getDependsOnTasks(a);return new K(a,c,this.R,b)},getHashCode:function(a){return this.R.getHashCode(a)},isEqual:function(a,b){return this.R.isEqual(a,b)}}}var b=self.asyncProxyScriptBlob;a.prototype=Object.create(H.prototype);b.f(L,"PromiseDependencyWorkers");return a}var O=L();function P(){asyncProxyScriptBlob.f(P,"ExportAsyncProxySymbols");asyncProxyScriptBlob.m("ExportAsyncProxySymbols(SubWorkerEmulationForChrome, AsyncProxySlaveSingleton, AsyncProxyMaster, ScriptsToImportPool, DependencyWorkers, DependencyWorkersTaskHandle, PromiseTask, PromiseDependencyWorkers);");asyncProxyScriptBlob.m("self['AsyncProxy']['AsyncProxySlaveSingleton'] = AsyncProxySlaveSingleton;");asyncProxyScriptBlob.m("self['AsyncProxy']['AsyncProxyMaster'] = AsyncProxyMaster;");asyncProxyScriptBlob.m("self['AsyncProxy']['ScriptsToImportPool'] = ScriptsToImportPool;");
asyncProxyScriptBlob.m("self['AsyncProxy']['DependencyWorkers'] = DependencyWorkers;");asyncProxyScriptBlob.m("self['AsyncProxy']['PromiseTask'] = PromiseTask;");asyncProxyScriptBlob.m("self['AsyncProxy']['PromiseDependencyWorkers'] = PromiseDependencyWorkers;");return function(a,c,b,e,f,d,g,n){self.AsyncProxy=self.AsyncProxy||{};a.prototype.postMessage=a.prototype.postMessage;a.prototype.terminate=a.prototype.terminate;c.setSlaveSideCreator=c.vb;c.setBeforeOperationListener=c.sb;c.sendUserDataToMaster=
c.rb;c.wrapPromiseFromSlaveSide=c.Pa;c.wrapCallbackFromSlaveSide=c.Oa;b.prototype.setUserDataHandler=b.prototype.wb;b.prototype.terminate=b.prototype.terminate;b.prototype.callFunction=b.prototype.xa;b.prototype.wrapCallback=b.prototype.Bb;b.prototype.freeCallback=b.prototype.Aa;b.getEntryUrl=b.Ba;e.prototype.addScriptFromErrorWithStackTrace=e.prototype.$a;e.prototype.getScriptsForWorkerImport=e.prototype.gb;f.prototype.startTask=f.prototype.Ma;d.prototype.hasData=d.prototype.Da;d.prototype.getLastData=
d.prototype.Ca;d.prototype.setPriority=d.prototype.ub;d.prototype.unregister=d.prototype.unregister;g.prototype.onDependencyTaskResult=g.prototype.lb;g.prototype.statusUpdated=g.prototype.xb;n.createInputRetreiverWrapper=n.prototype.Cb}}P()(v,A,x,z,H,G,K,O);self.AsyncProxy.AsyncProxySlaveSingleton=A;self.AsyncProxy.AsyncProxyMaster=x;self.AsyncProxy.ScriptsToImportPool=z;self.AsyncProxy.DependencyWorkers=H;self.AsyncProxy.PromiseTask=K;self.AsyncProxy.PromiseDependencyWorkers=O;
